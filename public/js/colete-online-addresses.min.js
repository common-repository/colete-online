"use strict";function ownKeys(t,e){var n,o=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),o.push.apply(o,n)),o}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _createForOfIteratorHelper(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,t=function(){};return{s:t,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,c=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){i=!0,a=e},f:function(){try{c||null==n.return||n.return()}finally{if(i)throw a}}}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}jQuery(function(s){if("undefined"==typeof wc_checkout_params&&"undefined"==typeof woocommerce_params)return!1;function r(e){return e=(e=(e=e.replace(/[iIîÎâÂaAăĂâÂ]/g,"a")).replace(/[tTȚț]/g,"t")).replace(/[sSȘș]/g,"s")}s(document.body).on("updated_checkout",function(){!function(){for(var e=s("select[id^='coleteonline_service_shipping_point-']"),t=0;t<e.length;++t)s(e[t]).select2()}()});var e="";"undefined"!=typeof wc_checkout_params?e=wc_checkout_params.ajax_url:"undefined"!=typeof woocommerce_params&&(e=woocommerce_params.ajax_url);var c=e;function u(){return"woocommerce"===coleteOnlineOptions.addressCityField}function d(){return coleteOnlineOptions.addressStreetField}function p(e){return"displayWithAutocomplete"===d()?"#".concat(e,"_street"):"#".concat(e,"_address_1")}function o(){return"no"!==coleteOnlineOptions.addressStreetNumberField}function _(e){return-1<["S1","S2","S3","S4","S5","S6"].indexOf(e)}function y(e,t){e.find("option[value='"+t+"']").length?e.val(t).trigger("change"):(t=new Option(t,t,!0,!0),e.append(t).trigger("change"))}function t(t){s("#".concat(t,"_phone")).length&&s.ajax({type:"POST",url:c,data:{action:"coleteonline_phone_number_check",phone_number:s("#".concat(t,"_phone")).val(),country:s("#".concat(t,"_country")).val()},success:function(e){null===(e=JSON.parse(e))||e.valid||e.error?(s("#".concat(t,"_phone_field")).removeClass("woocommerce-invalid"),s("#".concat(t,"_phone_field")).addClass("woocommerce-valid")):(s("#".concat(t,"_phone_field")).removeClass("woocommerce-valid"),s("#".concat(t,"_phone_field")).addClass("woocommerce-invalid"))}})}function a(t){var e=s("#".concat(t,"_state")).val(),n=s("#".concat(t,"_city")).val();"RO"!==s("#".concat(t,"_country")).val()?e="--":_(n)&&(n=(o=[e,n])[0],e=o[1],n="Bucuresti");var o=p(t),o=s(o).val();null!=o&&o.length||(o="--"),s.ajax({type:"GET",url:c,data:{action:"coleteonline_postal_code_search",country:s("#".concat(t,"_country")).val(),street:o,county:e,city:n,validate_street:2},success:function(e){1!=(e=JSON.parse(e)).error&&e.codes.length&&(s("#".concat(t,"_postcode")).val(e.codes[0].code),s("#".concat(t,"_postcode_field")).removeClass("woocommerce-invalid"),s("body").trigger("update_checkout"))}})}"undefined"!=typeof customAjaxPath&&void 0!==customAjaxPath.pluginsUrl&&(c=customAjaxPath.pluginsUrl);var n,i={shipping:void 0,billing:void 0},g={shipping:!1,billing:!1};function l(l,e){if(i[l]!==e){if(i[l]=e,g[l]&&(y(s("#".concat(l,"_city_state")),""),"displayWithAutocomplete"===d()&&y(s("#".concat(l,"_street")),""),y(s("#".concat(l,"_locality")),""),s("#".concat(l,"_city")).val(""),s("#".concat(l,"_postcode")).val(""),s("#".concat(l,"_address_1")).val(""),o()&&s("#".concat(l,"_street_number")).val("")),"RO"===e){if("no"===coleteOnlineOptions.postalCodePosition&&s("#".concat(l,"_postcode_field")).addClass("hidden-field"),"displayWithAutocomplete"===d()&&(s("#".concat(l,"_address_1_field")).addClass("hidden-field"),s("#".concat(l,"_street_field")).removeClass("hidden-field"),s("#".concat(l,"_street_field")).find(".optional").addClass("hidden-field")),o()&&(s("#".concat(l,"_street_number_field")).removeClass("hidden-field"),s("#".concat(l,"_street_number_field")).find(".optional").addClass("hidden-field")),coleteOnlineOptions.separateFields&&!u()?(s("#".concat(l,"_city_field")).addClass("hidden-field"),s("#".concat(l,"_city_field")).find(".optional").addClass("hidden-field"),s("#".concat(l,"_state_field")).removeClass("hidden-field"),s("#".concat(l,"_locality_field")).removeClass("hidden-field")):u()||(s("#".concat(l,"_state")).val()&&s("#".concat(l,"_city")).val()||(y(s("#".concat(l,"_city_state")),""),"displayWithAutocomplete"===d()&&y(s("#".concat(l,"_street")),"")),s("#".concat(l,"_state_field")).addClass("hidden-field"),s("#".concat(l,"_city_field")).addClass("hidden-field"),s("#".concat(l,"_locality_field")).addClass("hidden-field"),s("#".concat(l,"_city_state_field")).removeClass("hidden-field"),s("#".concat(l,"_city_state_field")).find(".optional").addClass("hidden-field")),g[l])return;u()||s("#".concat(l,"_city")).val()&&(_(t=s("#".concat(l,"_city")).val())&&(t=t.replace("S","Sectorul ")),y(s("#".concat(l,"_locality")),t));var t=s("#".concat(l,"_address_1")).val();void 0!==t&&t.length&&"displayWithAutocomplete"===d()&&y(s("#".concat(l,"_street")),t)}else"no"===coleteOnlineOptions.postalCodePosition&&s("#".concat(l,"_postcode_field")).removeClass("hidden-field"),o()&&(s("#".concat(l,"_street_number_field")).addClass("hidden-field"),s("#".concat(l,"_street_number_field")).find(".optional").addClass("hidden-field")),"displayWithAutocomplete"===d()&&(s("#".concat(l,"_address_1_field")).removeClass("hidden-field"),s("#".concat(l,"_street_field")).addClass("hidden-field")),coleteOnlineOptions.separateFields?u()||(s("#".concat(l,"_city_field")).removeClass("hidden-field"),s("#".concat(l,"_locality_field")).addClass("hidden-field")):(s("#".concat(l,"_state_field")).removeClass("hidden-field"),s("#".concat(l,"_city_field")).removeClass("hidden-field"),s("#".concat(l,"_city_state_field")).addClass("hidden-field")),""!==e||u()||s("#".concat(l,"_state_field")).addClass("hidden-field");var n;g[l]||(g[l]=!0,s("#".concat(l,"_postcode")).change(function(){var t,e,n,o,a,i;"RO"===s("#".concat(l,"_country")).val()?(i=l,s.ajax({type:"GET",url:c,data:{action:"coleteonline_reverse_postal_code_search",postal_code:s("#".concat(i,"_postcode")).val(),country:s("#".concat(i,"_country")).val()},success:function(c){var e,t,n;!0!==(c=JSON.parse(c)).error&&(e=function(){var e,t=p(i),n=s(t).val(),o=!1,a=_createForOfIteratorHelper(c.street);try{for(a.s();!(e=a.n()).done;)r(e.value).toLowerCase()===r(n).toLowerCase()&&(o=!0)}catch(e){a.e(e)}finally{a.f()}o||("displayWithAutocomplete"===d()&&y(s("#".concat(i,"_street")),c.street[0]),s("#".concat(i,"_address_1")).val(c.street[0]))},c.length||Object.keys(c).length?(s("#".concat(i,"_postcode_field")).removeClass("woocommerce-invalid"),coleteOnlineOptions.separateFields?(_(c.countyCode)?(s("#".concat(i,"_state")).val("B"),s("#".concat(i,"_state")).trigger("change"),s("#".concat(i,"_city")).val(c.countyCode),u()||y(s("#".concat(i,"_locality")),c.locality.county)):(s("#".concat(i,"_state")).val(c.countyCode),s("#".concat(i,"_state")).trigger("change"),s("#".concat(i,"_city")).val(c.locality.city),u()||y(s("#".concat(i,"_locality")),c.locality.city)),void 0!==c.street&&c.street.length&&e(),u()||s("#".concat(i,"_locality")).removeAttr("disabled"),s("body").trigger("update_checkout")):(s("#".concat(i,"_state")).val(c.countyCode),s("#".concat(i,"_city")).val(c.locality.city),t=c.locality,n="".concat(t.city,", ").concat(t.county),void 0!==c.street&&c.street.length?e():("displayWithAutocomplete"===d()&&y(s("#".concat(i,"_street")),""),s("#".concat(i,"_address_1")).val("")),t.city&&t.county&&y(s("#".concat(i,"_city_state")),"".concat(t.city,", ").concat(t.county)),s("#".concat(i,"_city_state")).trigger({type:"select2:select",params:{data:{countyCode:c.countyCode,id:n,text:n,countyName:t.county,cityName:t.city,trigger:!1}}}))):s("#".concat(i,"_postcode_field")).addClass("woocommerce-invalid"))}})):void 0!==(a=s("#".concat(t=l,"_postcode")).val())&&a.length&&(n=s("#".concat(t,"_state")).val(),e=s("#".concat(t,"_city")).val(),"RO"!==s("#".concat(t,"_country")).val()?n="--":_(e)&&(e=(o=[n,e])[0],n=o[1],e="Bucuresti"),o=p(t),null!=(o=s(o).val())&&o.length||(o="--"),void 0!==e&&e.length||(e="--"),s.ajax({type:"GET",url:c,data:{action:"coleteonline_validate_postal_code",country:s("#".concat(t,"_country")).val(),street:o,county:n,city:e,postal_code:a},success:function(e){if(1!=(e=JSON.parse(e)).error){if(!1===e.format||!1===e.location)return s("#".concat(t,"_postcode_field")).addClass("woocommerce-invalid"),void s("body").trigger("update_checkout");s("#".concat(t,"_postcode_field")).removeClass("woocommerce-invalid"),s("body").trigger("update_checkout")}else s("body").trigger("update_checkout")}}))}),s("#".concat(l,"_postcode")).keydown(function(e){e.stopPropagation()}),"displayWithAutocomplete"===d()&&(s("#".concat(l,"_street")).select2({ajax:{url:c,dataType:"json",delay:300,data:function(e){var t,n=s("#".concat(l,"_state")).val(),o=s("#".concat(l,"_city")).val();return _(o)&&(o=(t=[n,o])[0],n=t[1]),"B"===o&&(o="Bucuresti"),{action:"coleteonline_autocomplete_street",country:s("#".concat(l,"_country")).val(),county:n,city:o,q:e.term,page:null!==(e=e.page)&&void 0!==e?e:1}},processResults:function(e,t){if(null==e||!0===e.error)return{results:[],pagination:{more:!1}};var n=e.data.map(function(e){return{text:e.name,id:e.name}}),e=e.pagination;return{results:n,pagination:{more:e.currentPage<e.totalPages}}}},language:{errorLoading:function(){return coleteOnlineLanguage.streetSearch.errorLoading},inputTooLong:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.streetSearch.inputTooLong.replace("%d",e)},inputTooShort:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.streetSearch.inputTooShort.replace("%d",e)},loadingMore:function(){return coleteOnlineLanguage.streetSearch.loadingMore},noResults:function(){return coleteOnlineLanguage.streetSearch.noResults},searching:function(){return coleteOnlineLanguage.streetSearch.searching},removeAllItems:function(){return coleteOnlineLanguage.streetSearch.removeAllItems},removeItem:function(){return coleteOnlineLanguage.streetSearch.removeItem},search:function(){return coleteOnlineLanguage.streetSearch.search}},width:"100%",minimumInputLength:2,selectOnClose:"yes"===coleteOnlineOptions.autoSelectStreet,tags:!0,insertTag:function(e,t){for(var n=!1,o=r(t.text).toLowerCase(),a=0;a<e.length;++a){var c=r(e[a].text);s.trim(c).toLowerCase()===o&&(n=!0)}n||e.unshift(t)}}),s("#".concat(l,"_street")).on("select2:select",function(e){a(l),s("#".concat(l,"_address_1")).val(e.params.data.text)})),coleteOnlineOptions.separateFields?(n={ajax:{url:c,dataType:"json",delay:300,data:function(e){return"B"===s("#".concat(l,"_state")).val()&&(e.term||(e.term="S")),{action:"coleteonline_autocomplete_city",country:s("#".concat(l,"_country")).val(),county_code:s("#".concat(l,"_state")).val(),q:e.term,page:null!==(e=e.page)&&void 0!==e?e:1}},processResults:function(e,t){if(!0===e.error)return{results:[{text:t.term,id:t.term}],pagination:{more:!1}};for(var n=function(e){return{text:e.localityName,id:e.localityName,countyCode:e.countyCode,cityName:e.localityName,countyName:e.countyName}},o=function(e){return{text:e.countyName,id:e.countyName,countyCode:e.countyCode,cityName:e.countyName,countyName:e.localityName}},a=[],c=0;c<e.data.length;++c){var i=e.data[c],r=n;"B"===s("#".concat(l,"_state")).val()&&(r=o),i.list?a.push({text:i.upLocality+":",children:i.list.map(r)}):a.push(r(i))}t=e.pagination;return{results:a,pagination:{more:t.currentPage<t.totalPages}}}},language:{errorLoading:function(){return coleteOnlineLanguage.localitySearch.errorLoading},inputTooLong:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.localitySearch.inputTooLong.replace("%d",e)},inputTooShort:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.localitySearch.inputTooShort.replace("%d",e)},loadingMore:function(){return coleteOnlineLanguage.localitySearch.loadingMore},noResults:function(){return coleteOnlineLanguage.localitySearch.noResults},searching:function(){return coleteOnlineLanguage.localitySearch.searching},removeAllItems:function(){return coleteOnlineLanguage.localitySearch.removeAllItems},removeItem:function(){return coleteOnlineLanguage.localitySearch.removeItem},search:function(){return coleteOnlineLanguage.localitySearch.search}},width:"100%",minimumInputLength:"B"===s("#".concat(l,"_state")).val()?0:2,selectOnClose:"yes"===coleteOnlineOptions.autoSelectCity,templateSelection:function(e){return""===e.id?""===s("#".concat(l,"_state")).val()?shippingCityTranslations.emptyState:shippingCityTranslations.nonEmptyState:e.text}},u()||(s("#".concat(l,"_locality")).select2(n),""===s("#".concat(l,"_state")).val()&&s("#".concat(l,"_locality")).attr("disabled","disabled"),setTimeout(function(){s("#".concat(l,"_state")).on("select2:select",function(){s("#".concat(l,"_locality")).val(null).trigger("change"),"displayWithAutocomplete"===d()&&s("#".concat(l,"_street")).val(null).trigger("change"),s("#".concat(l,"_city")).val(null).trigger("change"),""===s("#".concat(l,"_state")).val()?s("#".concat(l,"_locality")).attr("disabled","disabled"):s("#".concat(l,"_locality")).removeAttr("disabled"),s("#".concat(l,"_locality")).trigger("change"),"B"===s("#".concat(l,"_state")).val()?s("#".concat(l,"_locality")).select2(_objectSpread(_objectSpread({},n),{},{minimumInputLength:0})):s("#".concat(l,"_locality")).select2(_objectSpread(_objectSpread({},n),{},{minimumInputLength:2}))}),s("#".concat(l,"_locality")).on("select2:select",function(e){var t;"B"===s("#".concat(l,"_state")).val()?s("#".concat(l,"_city")).val(null===(t=e.params)||void 0===t?void 0:t.data.countyCode):s("#".concat(l,"_city")).val(null===(e=e.params)||void 0===e?void 0:e.data.cityName),"displayWithAutocomplete"===d()&&s("#".concat(l,"_street")).val(null).trigger("change"),a(l)})},500))):(s("#".concat(l,"_city_state")).select2({ajax:{url:c,dataType:"json",delay:300,data:function(e){return{action:"coleteonline_autocomplete_city_state_merged",country:s("#".concat(l,"_country")).val(),q:e.term,page:null!==(e=e.page)&&void 0!==e?e:1}},processResults:function(e,t){if(!0===e.error)return s("#".concat(l,"_state")).val("B"),s("#".concat(l,"_city")).val(t.term),s("body").trigger("update_checkout"),{results:[{text:t.term,id:t.term}],pagination:{more:!1}};for(var n=[],o=function(e){var t="".concat(e.city,", ").concat(e.county);return{text:t,id:t,countyCode:e.countyCode,cityName:e.city,countyName:e.county}},a=0;a<e.data.length;++a){var c=e.data[a];c.list?n.push({text:c.upLocality+":",children:c.list.map(o)}):n.push(o(c))}t=e.pagination;return{results:n,pagination:{more:t.currentPage<t.totalPages}}}},language:{errorLoading:function(){return coleteOnlineLanguage.localityAndStateSearch.errorLoading},inputTooLong:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.localityAndStateSearch.inputTooLong.replace("%d",e)},inputTooShort:function(e){e=e.minimum-e.input.length;return coleteOnlineLanguage.localityAndStateSearch.inputTooShort.replace("%d",e)},loadingMore:function(){return coleteOnlineLanguage.localityAndStateSearch.loadingMore},noResults:function(){return coleteOnlineLanguage.localityAndStateSearch.noResults},searching:function(){return coleteOnlineLanguage.localityAndStateSearch.searching},removeAllItems:function(){return coleteOnlineLanguage.localityAndStateSearch.removeAllItems},removeItem:function(){return coleteOnlineLanguage.localityAndStateSearch.removeItem},search:function(){return coleteOnlineLanguage.localityAndStateSearch.search}},width:"100%",minimumInputLength:2,selectOnClose:"yes"===coleteOnlineOptions.autoSelectCity}),s("#".concat(l,"_city_state")).on("select2:select",function(e){var t;_(e.params.data.countyCode)&&(t=e.params.data.countyCode,e.params.data.countyCode="B",e.params.data.cityName=t),s("#".concat(l,"_state")).val(null===(t=e.params)||void 0===t?void 0:t.data.countyCode),s("#".concat(l,"_city")).val(null===(t=e.params)||void 0===t?void 0:t.data.cityName),!1!==e.params.data.trigger&&("displayWithAutocomplete"===d()&&s("#".concat(l,"_street")).val(null).trigger("change"),s("#".concat(l,"_address_1")).val(""),a(l)),s("body").trigger("update_checkout")})))}}function f(){s("form.checkout").on("change",'input[name="payment_method"]',function(){s(document.body).trigger("update_checkout")}),s("form.checkout").on("change",'input[name="open_package"]',function(){s(document.body).trigger("update_checkout")}),"woocommerceDefault"!==coleteOnlineOptions.checkoutFormType&&(coleteOnlineOptions.validatePhone&&(s("#billing_phone").change(function(){t("billing")}),t("billing"),s("#shipping_phone").change(function(){t("shipping")}),t("shipping")),s("#billing_country").on("select2:select select2:unselecting",function(){l("billing",s("#billing_country").val())}),l("billing",s("#billing_country").val()),s("#ship-to-different-address-checkbox").change(function(e){s("#ship-to-different-address-checkbox").val()&&l("shipping",s("#shipping_country").val())}),l("shipping",s("#shipping_country").val()),s("#shipping_country").on("select2:select select2:unselecting",function(){l("shipping",s("#shipping_country").val())}))}coleteOnlineOptions.isEditAddressPage?setTimeout(function(){f()},100):(n=!1,s("body").on("updated_checkout",function(){n||(n=!0,f())})),s(document).on("select2:open",function(){setTimeout(function(){var e=document.querySelector(".select2-search__field");e&&e.focus()},200)})});